initial version with StPSUTools shaved down to ~4900 lines
